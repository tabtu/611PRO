<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Online Quiz</title>

    <div th:replace="fragments/header :: header-css"/>

</head>
<body>

<div th:replace="fragments/header :: header"/>

<div class="container">
    <div class="quizcontainer">
        <div class="infobox">
            <div class="videobox">
            </div>
            <div class="timer1">
                <!--<video height="240px" autoplay="autoplay"></video><br />-->
                <!--<canvas id="mycanvas" th:height="240px"></canvas><br />-->
                <!--<meta name="usr" th:content="${#httpServletRequest.remoteUser}" />-->
                <!--<input type="button" title="Open Camera" value="open camera" onclick="getMedia();" />-->
                <!--<input type="button" title="Face Login" value="Face Login" onclick="submitForm();" /><hr />-->
            </div>
            <div class="timer2">
                <li class="timer2" th:type="" th:name="tmleft">Quiz Time left = <span id="timer"></span></li>
            </div>
            <div class="studentinfo">
                <p th:text="|Name: ${#httpServletRequest.remoteUser}|"></p>
            </div>
        </div>
        <div class="quizbox">
            <button type="button" id="startQuiz"> Start Quiz </button>
            <br /><br /><br />
            <form id="questionForm" action="@{/quiz}" th:action="@{/quiz}" method="post" style="display:none">
                <div class="resultItem" th:each="question:${questions}">
                    <span th:text="|${question.question_id}.${question.content}|"></span><br />
                    <input type="radio" value="A" th:name="${question.question_id}" /><span th:text="${question.optiona}"></span><br />
                    <input type="radio" value="B" th:name="${question.question_id}" /><span th:text="${question.optionb}"></span><br />
                    <input type="radio" value="C" th:name="${question.question_id}" /><span th:text="${question.optionc}"></span><br />
                    <input type="radio" value="D" th:name="${question.question_id}" /><span th:text="${question.optiond}"></span><br />
                </div>
                <br /><br />
                <button type="submit" id="submitBtn"> Submit Answers</button>
            </form>
        </div>
    </div>
</div>
<div th:replace="fragments/footer :: footer"/>
</body>
<!--<script type="text/javascript" th:src="@{/js/webcap.js}" src="/static/js/webcap.js"></script>-->
<script type="text/javascript" th:src="@{/js/jquery-1.12.4.min.js}" src="/static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" th:inline="javascript">
    /*<![CDATA[*/
//    var usr = $("meta[name='usr']").attr("content");
//    var video = document.querySelector('video');
//    var tcanvas = document.getElementById('mycanvas');
//    tcanvas.style.display="none";
//    var tcontext = tcanvas.getContext('2d');
//    var exArray = [];
//    MediaStreamTrack.getSources(function (sourceInfos) {
//        for (var i = 0; i != sourceInfos.length; ++i) {
//            var sourceInfo = sourceInfos[i];
//            if (sourceInfo.kind === 'video') {
//                exArray.push(sourceInfo.id);
//            }
//        }
//    });
//    navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
//    window.URL = window.URL || window.webkitURL || window.mozURL || window.msURL;

    $("#startQuiz").click(function() {
        document.getElementById('timer').innerHTML = 10 + ":" + 00;
        startTimer();
//        getMedia();
//        setInterval(submitForm(), 20000);
        $(this).hide(1);
        $("#questionForm").css("display", "block");
    });

    function startTimer() {
        var presentTime = document.getElementById('timer').innerHTML;
        var timeArray = presentTime.split(/[:]+/);
        var m = timeArray[0];
        var s = checkSecond((timeArray[1] - 1));
        if(s==59){m=m-1};
        if(m<0){
            alert('Time Out');
            window.location.href="login.html?backurl="+window.location.href;
        };

        document.getElementById('timer').innerHTML =
            m + ":" + s;
        setTimeout(startTimer, 1000);
    }

    function checkSecond(sec) {
        if (sec < 10 && sec >= 0) {sec = "0" + sec}; // add zero in front of numbers < 10
        if (sec < 0) {sec = "59"};
        return sec;
    };
    /*]]>*/
</script>
</html>